{"remainingRequest":"C:\\Users\\aidan\\Dev\\paradigm-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\aidan\\Dev\\paradigm-vue\\src\\views\\Flamechat.vue?vue&type=script&defer=true&lang=js&","dependencies":[{"path":"C:\\Users\\aidan\\Dev\\paradigm-vue\\src\\views\\Flamechat.vue","mtime":1546005687502},{"path":"C:\\Users\\aidan\\Dev\\paradigm-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\aidan\\Dev\\paradigm-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\aidan\\Dev\\paradigm-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\aidan\\Dev\\paradigm-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\n'use strict';\n\n// Signs-in Friendly Chat.\nfunction signIn() {\n  // Sign in Firebase using popup auth and Google as the identity provider.\n  var provider = new firebase.auth.GoogleAuthProvider();\n  firebase.auth().signInWithPopup(provider);\n}\n\n// Signs-out of Friendly Chat.\nfunction signOut() {\n  // Sign out of Firebase.\n  firebase.auth().signOut();\n}\n\n// Initiate firebase auth.\nfunction initFirebaseAuth() {\n  // Listen to auth state changes.\n  firebase.auth().onAuthStateChanged(authStateObserver);\n}\n\n// Returns the signed-in user's profile Pic URL.\nfunction getProfilePicUrl() {\n  return firebase.auth().currentUser.photoURL || '/assets/profile_placeholder.png';\n}\n\n// Returns the signed-in user's display name.\nfunction getUserName() {\n  return firebase.auth().currentUser.displayName;\n}\n\n// Returns true if a user is signed-in.\nfunction isUserSignedIn() {\n  return !!firebase.auth().currentUser;\n}\n\n// Loads chat messages history and listens for upcoming ones.\nfunction loadMessages() {\n  // Loads the last 12 messages and listen for new ones.\n  var callback = function(snap) {\n    var data = snap.val();\n    displayMessage(snap.key, data.name, data.text, data.profilePicUrl, data.imageUrl, data.date, data.time);\n  };\n\n  firebase.database().ref('/messages/').on('child_added', callback);\n  firebase.database().ref('/messages/').on('child_changed', callback);\n}\n\n// Saves a new message on the Firebase DB.\nfunction saveMessage(messageText) {\n  // Add a new message entry to the Firebase database.\n  var date = new Date(Date.now())\n  return firebase.database().ref('/messages/').push({\n    name: getUserName(),\n    text: messageText,\n    profilePicUrl: getProfilePicUrl(),\n    date: date.toLocaleDateString(),\n    time: date.toLocaleTimeString()\n  }).catch(function(error) {\n    console.error('Error writing new message to Firebase Database', error);\n  });\n}\n\n// Saves a new message containing an image in Firebase.\n// This first saves the image in Firebase storage.\nfunction saveImageMessage(file) {\n  // 1 - We add a message with a loading icon that will get updated with the shared image.\n  var date = new Date(Date.now())\n  firebase.database().ref('/messages/').push({\n    name: getUserName(),\n    imageUrl: LOADING_IMAGE_URL,\n    profilePicUrl: getProfilePicUrl(),\n    date: date.toLocaleDateString(),\n    time: date.toLocaleTimeString()\n  }).then(function(messageRef) {\n    // 2 - Upload the image to Cloud Storage.\n    var filePath = firebase.auth().currentUser.uid + '/' + messageRef.key + '/' + file.name;\n    return firebase.storage().ref(filePath).put(file).then(function(fileSnapshot) {\n      // 3 - Generate a public URL for the file.\n      return fileSnapshot.ref.getDownloadURL().then((url) => {\n        // 4 - Update the chat message placeholder with the imageâ€™s URL.\n        return messageRef.update({\n          imageUrl: url,\n          storageUri: fileSnapshot.metadata.fullPath\n        });\n      });\n    });\n  }).catch(function(error) {\n    console.error('There was an error uploading a file to Cloud Storage:', error);\n  });\n}\n\n// Saves the messaging device token to the datastore.\nfunction saveMessagingDeviceToken() {\n  firebase.messaging().getToken().then(function(currentToken) {\n    if (currentToken) {\n      console.log('Got FCM device token:', currentToken);\n      // Saving the Device Token to the datastore.\n      firebase.database().ref('/fcmTokens').child(currentToken)\n          .set(firebase.auth().currentUser.uid);\n    } else {\n      // Need to request permissions to show notifications.\n      requestNotificationsPermissions();\n    }\n  }).catch(function(error){\n    console.error('Unable to get messaging token.', error);\n  });\n}\n\n// Requests permissions to show notifications.\nfunction requestNotificationsPermissions() {\n  console.log('Requesting notifications permission...');\n  firebase.messaging().requestPermission().then(function() {\n    // Notification permission granted.\n    saveMessagingDeviceToken();\n  }).catch(function(error) {\n    console.error('Unable to get permission to notify.', error);\n  });\n}\n\n// Triggered when a file is selected via the media picker.\nfunction onMediaFileSelected(event) {\n  event.preventDefault();\n  var file = event.target.files[0];\n\n  // Clear the selection in the file picker input.\n  imageFormElement.reset();\n\n  // Check if the file is an image.\n  if (!file.type.match('image.*')) {\n    var data = {\n      message: 'You can only send images',\n      timeout: 2000\n    };\n    signInSnackbarElement.MaterialSnackbar.showSnackbar(data);\n    return;\n  }\n  // Check if the user is signed-in\n  if (checkSignedInWithMessage()) {\n    saveImageMessage(file);\n  }\n}\n\n// Triggered when the send new message form is submitted.\nfunction onMessageFormSubmit(e) {\n  e.preventDefault();\n  // Check that the user entered a message and is signed in.\n  if (messageInputElement.value && checkSignedInWithMessage()) {\n    saveMessage(messageInputElement.value).then(function() {\n      // Clear message text field and re-enable the SEND button.\n      resetMaterialTextfield(messageInputElement);\n      toggleButton();\n    });\n  }\n}\n\n// Triggers when the auth state change for instance when the user signs-in or signs-out.\nfunction authStateObserver(user) {\n  if (user) { // User is signed in!\n    // Get the signed-in user's profile pic and name.\n    var profilePicUrl = getProfilePicUrl();\n    var userName = getUserName();\n\n    // Set the user's profile pic and name.\n    userPicElement.style.backgroundImage = 'url(' + profilePicUrl + ')';\n    userNameElement.textContent = userName;\n\n    // Show user's profile and sign-out button.\n    userNameElement.removeAttribute('hidden');\n    userPicElement.removeAttribute('hidden');\n    signOutButtonElement.removeAttribute('hidden');\n\n    // Hide sign-in button.\n    signInButtonElement.setAttribute('hidden', 'true');\n\n    // We save the Firebase Messaging Device token and enable notifications.\n    saveMessagingDeviceToken();\n  } else { // User is signed out!\n    // Hide user's profile and sign-out button.\n    userNameElement.setAttribute('hidden', 'true');\n    userPicElement.setAttribute('hidden', 'true');\n    signOutButtonElement.setAttribute('hidden', 'true');\n\n    // Show sign-in button.\n    signInButtonElement.removeAttribute('hidden');\n  }\n}\n\n// Returns true if user is signed-in. Otherwise false and displays a message.\nfunction checkSignedInWithMessage() {\n  // Return true if the user is signed in Firebase\n  if (isUserSignedIn()) {\n    return true;\n  }\n\n  // Display a message to the user using a Toast.\n  var data = {\n    message: 'You must sign-in first',\n    timeout: 2000\n  };\n  signInSnackbarElement.MaterialSnackbar.showSnackbar(data);\n  return false;\n}\n\n// Resets the given MaterialTextField.\nfunction resetMaterialTextfield(element) {\n  element.value = '';\n  element.parentNode.MaterialTextfield.boundUpdateClassesHandler();\n}\n\n// Template for messages.\nvar MESSAGE_TEMPLATE =\n    '<div class=\"message-container\">' +\n      '<div class=\"spacing\"><div class=\"pic\"></div></div>' +\n      '<div class=\"message\"></div>' +\n      '<div class=\"nameDateTime\"></div>'\n    '</div>';\n\n// Adds a size to Google Profile pics URLs.\nfunction addSizeToGoogleProfilePic(url) {\n  if (url.indexOf('googleusercontent.com') !== -1 && url.indexOf('?') === -1) {\n    return url + '?sz=150';\n  }\n  return url;\n}\n\n// A loading image URL.\nvar LOADING_IMAGE_URL = './assets/loader.gif';\n\n// Displays a Message in the UI.\nfunction displayMessage(key, name, text, picUrl, imageUrl, date, time) {\n  var div = document.getElementById(key);\n  // If an element for that message does not exists yet we create it.\n  if (!div) {\n    var container = document.createElement('div');\n    container.innerHTML = MESSAGE_TEMPLATE;\n    div = container.firstChild;\n    div.setAttribute('id', key);\n    messageListElement.appendChild(div);\n  }\n  if (picUrl) {\n    div.querySelector('.pic').style.backgroundImage = 'url(' + addSizeToGoogleProfilePic(picUrl) + ')';\n  }\n  div.querySelector('.nameDateTime').textContent = name + \" sent this on \" + date + \" at \" + time;\n  var messageElement = div.querySelector('.message');\n  if (text) { // If the message is text.\n    messageElement.textContent = text;\n    // Replace all line breaks by <br>.\n    messageElement.innerHTML = messageElement.innerHTML.replace(/\\n/g, '<br>');\n  } else if (imageUrl) { // If the message is an image.\n    var image = document.createElement('img');\n    image.addEventListener('load', function() {\n      messageListElement.scrollTop = messageListElement.scrollHeight;\n    });\n    image.src = imageUrl + '&' + new Date().getTime();\n    messageElement.innerHTML = '';\n    messageElement.appendChild(image);\n  }\n  // Show the card fading-in and scroll to view the new message.\n  setTimeout(function() {div.classList.add('visible')}, 1);\n  messageListElement.scrollTop = messageListElement.scrollHeight;\n  messageInputElement.focus();\n}\n\n// Enables or disables the submit button depending on the values of the input\n// fields.\nfunction toggleButton() {\n  if (messageInputElement.value) {\n    submitButtonElement.removeAttribute('disabled');\n  } else {\n    submitButtonElement.setAttribute('disabled', 'true');\n  }\n}\n\n// Checks that the Firebase SDK has been correctly setup and configured.\nfunction checkSetup() {\n  if (!window.firebase || !(firebase.app instanceof Function) || !firebase.app().options) {\n    window.alert('You have not configured and imported the Firebase SDK. ' +\n        'Make sure you go through the codelab setup instructions and make ' +\n        'sure you are running the codelab using `firebase serve`');\n  }\n}\n\n// Checks that Firebase has been imported.\ncheckSetup();\n\n// Shortcuts to DOM Elements.\nvar messageListElement = document.getElementById('messages');\nvar messageFormElement = document.getElementById('message-form');\nvar messageInputElement = document.getElementById('message');\nvar submitButtonElement = document.getElementById('submit');\nvar imageButtonElement = document.getElementById('submitImage');\nvar imageFormElement = document.getElementById('image-form');\nvar mediaCaptureElement = document.getElementById('mediaCapture');\nvar userPicElement = document.getElementById('user-pic');\nvar userNameElement = document.getElementById('user-name');\nvar signInButtonElement = document.getElementById('sign-in');\nvar signOutButtonElement = document.getElementById('sign-out');\nvar signInSnackbarElement = document.getElementById('must-signin-snackbar');\n\n// Saves message on form submit.\nmessageFormElement.addEventListener('submit', onMessageFormSubmit);\nsignOutButtonElement.addEventListener('click', signOut);\nsignInButtonElement.addEventListener('click', signIn);\n\n// Toggle for the button.\nmessageInputElement.addEventListener('keyup', toggleButton);\nmessageInputElement.addEventListener('change', toggleButton);\n\n// Events for image upload.\nimageButtonElement.addEventListener('click', function(e) {\n  e.preventDefault();\n  mediaCaptureElement.click();\n});\nmediaCaptureElement.addEventListener('change', onMediaFileSelected);\n\n// initialize Firebase\ninitFirebaseAuth();\n\n// We load currently existing chat messages and listen to new ones.\nloadMessages();\n",{"version":3,"sources":["Flamechat.vue"],"names":[],"mappings":";;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA","file":"Flamechat.vue","sourceRoot":"src\\views","sourcesContent":["<template>\n  <div class=\"about\">\n    <h1>This is an about page</h1>\n  </div>\n</template>\n\n<script defer>\n'use strict';\n\n// Signs-in Friendly Chat.\nfunction signIn() {\n  // Sign in Firebase using popup auth and Google as the identity provider.\n  var provider = new firebase.auth.GoogleAuthProvider();\n  firebase.auth().signInWithPopup(provider);\n}\n\n// Signs-out of Friendly Chat.\nfunction signOut() {\n  // Sign out of Firebase.\n  firebase.auth().signOut();\n}\n\n// Initiate firebase auth.\nfunction initFirebaseAuth() {\n  // Listen to auth state changes.\n  firebase.auth().onAuthStateChanged(authStateObserver);\n}\n\n// Returns the signed-in user's profile Pic URL.\nfunction getProfilePicUrl() {\n  return firebase.auth().currentUser.photoURL || '/assets/profile_placeholder.png';\n}\n\n// Returns the signed-in user's display name.\nfunction getUserName() {\n  return firebase.auth().currentUser.displayName;\n}\n\n// Returns true if a user is signed-in.\nfunction isUserSignedIn() {\n  return !!firebase.auth().currentUser;\n}\n\n// Loads chat messages history and listens for upcoming ones.\nfunction loadMessages() {\n  // Loads the last 12 messages and listen for new ones.\n  var callback = function(snap) {\n    var data = snap.val();\n    displayMessage(snap.key, data.name, data.text, data.profilePicUrl, data.imageUrl, data.date, data.time);\n  };\n\n  firebase.database().ref('/messages/').on('child_added', callback);\n  firebase.database().ref('/messages/').on('child_changed', callback);\n}\n\n// Saves a new message on the Firebase DB.\nfunction saveMessage(messageText) {\n  // Add a new message entry to the Firebase database.\n  var date = new Date(Date.now())\n  return firebase.database().ref('/messages/').push({\n    name: getUserName(),\n    text: messageText,\n    profilePicUrl: getProfilePicUrl(),\n    date: date.toLocaleDateString(),\n    time: date.toLocaleTimeString()\n  }).catch(function(error) {\n    console.error('Error writing new message to Firebase Database', error);\n  });\n}\n\n// Saves a new message containing an image in Firebase.\n// This first saves the image in Firebase storage.\nfunction saveImageMessage(file) {\n  // 1 - We add a message with a loading icon that will get updated with the shared image.\n  var date = new Date(Date.now())\n  firebase.database().ref('/messages/').push({\n    name: getUserName(),\n    imageUrl: LOADING_IMAGE_URL,\n    profilePicUrl: getProfilePicUrl(),\n    date: date.toLocaleDateString(),\n    time: date.toLocaleTimeString()\n  }).then(function(messageRef) {\n    // 2 - Upload the image to Cloud Storage.\n    var filePath = firebase.auth().currentUser.uid + '/' + messageRef.key + '/' + file.name;\n    return firebase.storage().ref(filePath).put(file).then(function(fileSnapshot) {\n      // 3 - Generate a public URL for the file.\n      return fileSnapshot.ref.getDownloadURL().then((url) => {\n        // 4 - Update the chat message placeholder with the imageâ€™s URL.\n        return messageRef.update({\n          imageUrl: url,\n          storageUri: fileSnapshot.metadata.fullPath\n        });\n      });\n    });\n  }).catch(function(error) {\n    console.error('There was an error uploading a file to Cloud Storage:', error);\n  });\n}\n\n// Saves the messaging device token to the datastore.\nfunction saveMessagingDeviceToken() {\n  firebase.messaging().getToken().then(function(currentToken) {\n    if (currentToken) {\n      console.log('Got FCM device token:', currentToken);\n      // Saving the Device Token to the datastore.\n      firebase.database().ref('/fcmTokens').child(currentToken)\n          .set(firebase.auth().currentUser.uid);\n    } else {\n      // Need to request permissions to show notifications.\n      requestNotificationsPermissions();\n    }\n  }).catch(function(error){\n    console.error('Unable to get messaging token.', error);\n  });\n}\n\n// Requests permissions to show notifications.\nfunction requestNotificationsPermissions() {\n  console.log('Requesting notifications permission...');\n  firebase.messaging().requestPermission().then(function() {\n    // Notification permission granted.\n    saveMessagingDeviceToken();\n  }).catch(function(error) {\n    console.error('Unable to get permission to notify.', error);\n  });\n}\n\n// Triggered when a file is selected via the media picker.\nfunction onMediaFileSelected(event) {\n  event.preventDefault();\n  var file = event.target.files[0];\n\n  // Clear the selection in the file picker input.\n  imageFormElement.reset();\n\n  // Check if the file is an image.\n  if (!file.type.match('image.*')) {\n    var data = {\n      message: 'You can only send images',\n      timeout: 2000\n    };\n    signInSnackbarElement.MaterialSnackbar.showSnackbar(data);\n    return;\n  }\n  // Check if the user is signed-in\n  if (checkSignedInWithMessage()) {\n    saveImageMessage(file);\n  }\n}\n\n// Triggered when the send new message form is submitted.\nfunction onMessageFormSubmit(e) {\n  e.preventDefault();\n  // Check that the user entered a message and is signed in.\n  if (messageInputElement.value && checkSignedInWithMessage()) {\n    saveMessage(messageInputElement.value).then(function() {\n      // Clear message text field and re-enable the SEND button.\n      resetMaterialTextfield(messageInputElement);\n      toggleButton();\n    });\n  }\n}\n\n// Triggers when the auth state change for instance when the user signs-in or signs-out.\nfunction authStateObserver(user) {\n  if (user) { // User is signed in!\n    // Get the signed-in user's profile pic and name.\n    var profilePicUrl = getProfilePicUrl();\n    var userName = getUserName();\n\n    // Set the user's profile pic and name.\n    userPicElement.style.backgroundImage = 'url(' + profilePicUrl + ')';\n    userNameElement.textContent = userName;\n\n    // Show user's profile and sign-out button.\n    userNameElement.removeAttribute('hidden');\n    userPicElement.removeAttribute('hidden');\n    signOutButtonElement.removeAttribute('hidden');\n\n    // Hide sign-in button.\n    signInButtonElement.setAttribute('hidden', 'true');\n\n    // We save the Firebase Messaging Device token and enable notifications.\n    saveMessagingDeviceToken();\n  } else { // User is signed out!\n    // Hide user's profile and sign-out button.\n    userNameElement.setAttribute('hidden', 'true');\n    userPicElement.setAttribute('hidden', 'true');\n    signOutButtonElement.setAttribute('hidden', 'true');\n\n    // Show sign-in button.\n    signInButtonElement.removeAttribute('hidden');\n  }\n}\n\n// Returns true if user is signed-in. Otherwise false and displays a message.\nfunction checkSignedInWithMessage() {\n  // Return true if the user is signed in Firebase\n  if (isUserSignedIn()) {\n    return true;\n  }\n\n  // Display a message to the user using a Toast.\n  var data = {\n    message: 'You must sign-in first',\n    timeout: 2000\n  };\n  signInSnackbarElement.MaterialSnackbar.showSnackbar(data);\n  return false;\n}\n\n// Resets the given MaterialTextField.\nfunction resetMaterialTextfield(element) {\n  element.value = '';\n  element.parentNode.MaterialTextfield.boundUpdateClassesHandler();\n}\n\n// Template for messages.\nvar MESSAGE_TEMPLATE =\n    '<div class=\"message-container\">' +\n      '<div class=\"spacing\"><div class=\"pic\"></div></div>' +\n      '<div class=\"message\"></div>' +\n      '<div class=\"nameDateTime\"></div>'\n    '</div>';\n\n// Adds a size to Google Profile pics URLs.\nfunction addSizeToGoogleProfilePic(url) {\n  if (url.indexOf('googleusercontent.com') !== -1 && url.indexOf('?') === -1) {\n    return url + '?sz=150';\n  }\n  return url;\n}\n\n// A loading image URL.\nvar LOADING_IMAGE_URL = './assets/loader.gif';\n\n// Displays a Message in the UI.\nfunction displayMessage(key, name, text, picUrl, imageUrl, date, time) {\n  var div = document.getElementById(key);\n  // If an element for that message does not exists yet we create it.\n  if (!div) {\n    var container = document.createElement('div');\n    container.innerHTML = MESSAGE_TEMPLATE;\n    div = container.firstChild;\n    div.setAttribute('id', key);\n    messageListElement.appendChild(div);\n  }\n  if (picUrl) {\n    div.querySelector('.pic').style.backgroundImage = 'url(' + addSizeToGoogleProfilePic(picUrl) + ')';\n  }\n  div.querySelector('.nameDateTime').textContent = name + \" sent this on \" + date + \" at \" + time;\n  var messageElement = div.querySelector('.message');\n  if (text) { // If the message is text.\n    messageElement.textContent = text;\n    // Replace all line breaks by <br>.\n    messageElement.innerHTML = messageElement.innerHTML.replace(/\\n/g, '<br>');\n  } else if (imageUrl) { // If the message is an image.\n    var image = document.createElement('img');\n    image.addEventListener('load', function() {\n      messageListElement.scrollTop = messageListElement.scrollHeight;\n    });\n    image.src = imageUrl + '&' + new Date().getTime();\n    messageElement.innerHTML = '';\n    messageElement.appendChild(image);\n  }\n  // Show the card fading-in and scroll to view the new message.\n  setTimeout(function() {div.classList.add('visible')}, 1);\n  messageListElement.scrollTop = messageListElement.scrollHeight;\n  messageInputElement.focus();\n}\n\n// Enables or disables the submit button depending on the values of the input\n// fields.\nfunction toggleButton() {\n  if (messageInputElement.value) {\n    submitButtonElement.removeAttribute('disabled');\n  } else {\n    submitButtonElement.setAttribute('disabled', 'true');\n  }\n}\n\n// Checks that the Firebase SDK has been correctly setup and configured.\nfunction checkSetup() {\n  if (!window.firebase || !(firebase.app instanceof Function) || !firebase.app().options) {\n    window.alert('You have not configured and imported the Firebase SDK. ' +\n        'Make sure you go through the codelab setup instructions and make ' +\n        'sure you are running the codelab using `firebase serve`');\n  }\n}\n\n// Checks that Firebase has been imported.\ncheckSetup();\n\n// Shortcuts to DOM Elements.\nvar messageListElement = document.getElementById('messages');\nvar messageFormElement = document.getElementById('message-form');\nvar messageInputElement = document.getElementById('message');\nvar submitButtonElement = document.getElementById('submit');\nvar imageButtonElement = document.getElementById('submitImage');\nvar imageFormElement = document.getElementById('image-form');\nvar mediaCaptureElement = document.getElementById('mediaCapture');\nvar userPicElement = document.getElementById('user-pic');\nvar userNameElement = document.getElementById('user-name');\nvar signInButtonElement = document.getElementById('sign-in');\nvar signOutButtonElement = document.getElementById('sign-out');\nvar signInSnackbarElement = document.getElementById('must-signin-snackbar');\n\n// Saves message on form submit.\nmessageFormElement.addEventListener('submit', onMessageFormSubmit);\nsignOutButtonElement.addEventListener('click', signOut);\nsignInButtonElement.addEventListener('click', signIn);\n\n// Toggle for the button.\nmessageInputElement.addEventListener('keyup', toggleButton);\nmessageInputElement.addEventListener('change', toggleButton);\n\n// Events for image upload.\nimageButtonElement.addEventListener('click', function(e) {\n  e.preventDefault();\n  mediaCaptureElement.click();\n});\nmediaCaptureElement.addEventListener('change', onMediaFileSelected);\n\n// initialize Firebase\ninitFirebaseAuth();\n\n// We load currently existing chat messages and listen to new ones.\nloadMessages();\n</script>"]}]}